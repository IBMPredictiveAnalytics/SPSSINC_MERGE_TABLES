<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Объединение двух таблиц средства просмотра</title>
  <style type="text/css">

  <!-- 

  H1 {font-weight:bold; color:#006699; font-size:125%; }
  H2 {font-weight:bold; color:#006699; font-size:110%; }
  TABLE {font-size:100%;}

  /* paragraph tags */
  .step {text-indent: -1.3em; margin-left:1.3em; margin-top: 0px;}
  .menuselection {margin-left:10px}
  .bullet {list-style-type: disc;margin-top:12px; margin-left:36px; text-indent:-1em; }
  .codeblock {background-color: #ffffe6; display:block; margin-left:5px; padding:5px;}

  /* inline tags */
  .screen {font-weight:bold; color:#408080}                       /*** used refer to on-screen text ***/
  .name {font-style: italic}                                                       /*** used to tag names, such as variable names, file names, and so forth ***/
  .runinhead {font-weight: bold} 
  .superscript {vertical-align:super; font-size:80%}
  .subscript {vertical-align:sub; font-size:80%}


  --> 
  </style>
</head>

<body>
  <h1>Объединение двух таблиц средства просмотра</h1>Данная процедура объединяет значения ячеек одной таблицы со значениями другой таблицы. Предоставляющая
  таблица называется также вторичной таблицей, а принимающая - первичной
  таблицей. Это чаще всего используется для объединения тестовых таблиц долей или средних из процедуры Настраиваемые таблицы с основной таблицей, однако возможно много других видов объединения.

  <p>Ячейки для комбинирования объединяются с помощью меток строк
  и столбцов двух таблиц. Эти таблицы можно объединить, используя имя на
  самом внутреннем уровне (например, "Количество"), указав, куда должны
  направляться значения в случаях, когда одна и та же метка категории
  может относиться к нескольким статистикам. Некоторые виды таблиц нельзя
  объединять. Возможно, это придется выяснять опытным путем.</p>

  <p class="bullet">•&nbsp;Сноски из вторичной таблицы не переносятся
  в первичную таблицу.</p>

  <p><span class="runinhead">Точка присоединения.</span> Указывает
  измерение, содержащее метку первичной таблицы, которая определяет,
  где будут добавлены значения вторичной таблицы, если они есть.</p>

  <p><span class="runinhead">Метка в первичной таблице.</span>
  Позволяет (необязательно) задать метку самого нижнего уровня,
  куда надо вставить вторичные значения. Например, таблица может содержать метки
  "Количество" и "Процент" для каждой из категорий переменных. Этот элемент управления
  дает возможность выбрать, какую из них использовать.</p>

  <p class="bullet">•&nbsp;Очищает поле, если такие повторяющиеся метки
  отсутствуют и для задания объединения следует использовать сами
  значения категорий. Однако имейте в виду, что метка иногда может
  присутствовать, но быть скрыта, и ее нужно указать. Это особенно вероятно,
  если в настраиваемых таблицах вы выберете Скрыть метку статистики.</p>

  <p><span class="runinhead">Тип первичной и вторичной
  таблицы.</span> По умолчанию эта процедура объединяет две последние
  таблицы в средстве просмотра, рассматривая последнюю как вторичную
  таблицу. Введите подтипы таблицы OMS, чтобы задать другие таблицы. Другой
  вариант - ввести пару абсолютных номеров элементов средства просмотра.
  Номер корневого элемента средства просмотра - 0.</p>

  <p class="bullet">•&nbsp;Необходимо ввести или оба подтипа, или не
  вводить никаких подтипов.</p>

  <p class="bullet">•&nbsp;Чтобы узнать подтип таблицы, щелкните правой кнопкой
  по заголовку примера или воспользуйтесь диалоговым окном Идентификаторы OMS
  в меню <span class="screen">Утилиты</span>.</p>

  <p class="bullet">•&nbsp;Поиск таблиц выполняется в обратную сторону
  из конца средства просмотра.</p>

  <p><span class="runinhead">Режим слияния.</span> Выберите <span class=
  "screen">Добавлять вторичное значение ячейки к первичному</span>, чтобы
  вторичные значения добавлялись к первичным. Выберите
  <span class="screen">Заменять первичное значение ячейки вторичным</span>, чтобы
  заменять значения первичной таблицы на вторичные значения. Если вторичное значение
  недоступно, сохраняется первичное значение.</p>

  <p><span class="runinhead">Скрыть вторичную таблицу после
  слияния.</span> Включите этот переключатель, чтобы сделать вторичную таблицу
  невидимой после слияния.</p>

  <p><span class="runinhead">Добавить заголовок вторичной таблицы в
  первичную таблицу.</span> Включите этот переключатель, чтобы добавить заголовок
  вторичной таблицы в конец заголовка первичной таблицы.</p>

  <p><span class="runinhead">Добавить информацию вторичной подписи.</span> Включите этот переключатель, чтобы добавить подпись из
  вторичной таблицы в подпись первичной таблицы. (Эта опция недоступна
  в некоторых версиях IBM® SPSS® Statistics.)</p>

  <p><span class="runinhead">Добавить вторичную метку.</span> Включите
  этот переключатель, чтобы добавить метку из вторичной таблицы
  в соответствующий столбец первичной таблицы. Она будет включать
  один или несколько разделительных символов, используемых в ячейках данных.</p>

  <p><span class="runinhead">Подавлять сноску предупреждения
  слоя.</span> Эта процедура работает только в верхнем слое
  таблицы. Если в таблице есть дополнительные слои, будет добавлена
  предупреждающая сноска. Включите этот переключатель, чтобы не показывать эту сноску.</p>

  <p><span class="runinhead">Печать уровней метки для первой строки
  и столбца.</span> Включите этот переключатель, чтобы посмотреть все
  уровни меток обеих таблиц до и после преобразования. Поскольку таблицы
  часто содержат скрытые уровни, эта информация полезна при задании способа
  соотнесения меток двух таблиц.</p>

  <p><span class="runinhead">Выровнять ячейки по горизонтали
  после слияния.</span> Эти элементы управления позволяют задать,
  как выравниваются значения ячеек после объединения.</p>

  <p><span class="runinhead">Пользовательские символы-разделители.</span>
  Введите один или несколько символов для разделения первичных и вторичных
  значений в ячейке. Используйте "\n", чтобы указать, что значения должны располагаться
  в разных строках.</p>

  <p><span class="runinhead">Объединения.</span> Нажмите кнопку
  <span class="screen">Объединения</span>, чтобы задать сведения о том,
  как объединяются метки.</p>

  <h2>Диалоговое окно Настроить правила объединения меток</h2>Ячейки мобильной таблицы
  соотносятся друг с другом по следующим правилам, которые применяются к меткам
  строк и столбцов.

  <p class="bullet">•&nbsp; Метки фильтруются путем выбора
  уровней. Вы можете выбрать уровни, используемые для соотнесения ячеек,
  введя одно или несколько чисел в элементы управления первичных и вторичных
  строки и столбца. Например, если измерение таблицы содержит
  набор меток<br>
  <span class="code">A B C</span><br>
  уровню 0 соответствует A, уровню 1 - B, а уровню 2 - C.
  Если ввести в элементе управления 1, 2, набор меток преобразуется в<br>
  <span class="code">B C</span><br>
  до попытки соотнести его с набором меток в соответствующем измерении другой таблицы. Возможно, для другой структуры вам потребуется
  выбрать другие значения в этих двух таблицах.</p>

  <p class="bullet">•&nbsp; Преобразование набора меток использует числа
  в том порядке, в котором они вводились. Поэтому сочетания 1 2 и 2 1 дадут
  разные результаты.</p>

  <p class="bullet">•&nbsp; Переключатель <span class="screen">Печать
  уровней меток для первой строки и столбца</span> главного диалогового окна
  служит для выявления полной структуры таблиц.</p>

  <p class="bullet">•&nbsp;После фильтрации уровней можно вызвать написанные
  пользователем или стандартные функции Python для дальнейшего преобразования меток. Например, в одной из таблиц может быть метка
  <span class="screen">"Корреляция Пирсона"</span>, а соответствующая метка
  в другой таблице  может быть <span class="screen">"Коэффициент корреляции"</span>. Настраиваемая функция может преобразовать одну из меток так, что полученные в результате наборы
  будут совпадать.</p>

  <p class="bullet">•&nbsp;Настраиваемые таблицы могут содержать скрытый уровень
  "Статистика". По умолчанию этот уровень опускается при слиянии таблиц
  значимости в одну главную таблицу. Это можно переопределить в
  синтаксисе.</p>

  <p class="bullet">•&nbsp;Если функция возвратила Нет, эта ячейка
  не будет участвовать в слиянии.</p>

  <p class="bullet">•&nbsp;Действия, выполняемые стандартными функциями,
  зависят от параметра <span class="screen">Измерение точки
  присоединения</span>. Если задано значение <span class="screen">Столбец</span>,
  функция строки не будет выполнять никаких действий, а функция столбца
  удалит последний уровень метки столбца. Если задано значение <span class="screen">Строка</span>,
  функция строки удалит последний уровень метки, если она совпадает с меткой точки
  присоединения. Функция столбца удалит последний уровень во вторичной таблице,
  но никак не повлияет на первичную таблицу.</p>

  <p class="bullet">•&nbsp;Стандартные функции предназначены для работы
  с главной таблицей Настраиваемые таблицы и тестовыми таблицами Пропорции столбцов
  и Средние по столбцам. Как правило, для этих таблиц нет необходимости
  использовать фильтрацию уровней. Метка точки присоединения в элементах управления
  главной таблицы служит для добавления вторичного значения, если главная таблица
  содержит для каждой категории более одной статистики.
  При желании можно подавить использование стандартных функций
  для других типов слияния.</p>

  <p><span class="runinhead">Тип функции объединения.</span> Выберите
  стандартный или пользовательский набор функций.</p>

  <p class="bullet">•&nbsp;Если вы выбрали пользовательский набор, не будет
  применяться ни стандартная функция строки, ни стандартная функция столбца.
  Будут применяться только именованные функции строки или столбца,
  если они есть. Указывать обе функции - и столбца, и строки - нет
  необходимости. Таким образом, если вы выбрали Настраиваемые и при этом не ввели
  имен функций, то функции не будут применяться.</p>

  <p><span class="runinhead">Настраиваемая функция строки или столбца.</span>
  Введите имена функций в форме<br>
  модуль.функция<br>
  где "модуль" - имя модуля Python, в котором определена
  функция. Эти функции будут использоваться, только если включена вторая
  радиокнопка.</p>

  <h2>Дополнительные возможности</h2>

  <p>Этот диалог формирует синтаксис для команды расширения SPSSINC MERGE TABLES. Чтобы показать справку для этой команды, выполните следующий синтаксис:</p>

  <p class="codeblock">SPSSINC MERGE TABLES /HELP.</p>

  <p>Для других способов выбора первичной и вторичной таблицы в синтаксисе
  доступны дополнительные возможности. Для сложных таблиц может оказаться
  необходимо написать пользовательские функции rowfunc и colfunc для
  предварительной обработки меток строк и столбцов перед объединением.
  Возможно также слияние таблиц на основе номеров строк или столбцов,
  а не текста меток. Для иллюстрации этого SPSSINC_MERGE_TABLES
  содержит функции примера rowfuncbynumber и colfuncbynumber. В модуле SPSSINC_MERGE_TABLES.py содержится
  дальнейшая информация по использованию настраиваемых функций объединения.</p>

  <h2>Технические требования</h2>

  <p>Данное диалоговое окно требует надстройку интеграции для Python и команду расширения SPSSINC MERGE TABLES. Для IBM SPSS Statistics 19 и выше эти надстройка и команда расширения устанавливаются вместе с пакетом Essentials for Python. Дополнительные сведения смотрите в разделе How to Get Integration Plug-Ins (Получение подключаемых модулей интеграции).
Этот раздел находится в системе справки IBM SPSS Statistics: Core System &gt; Frequently Asked Questions (Основная система &gt; Часто задаваемые вопросы). Если вы скачали SPSSINC MERGE TABLES из SPSS Community, то следуйте инструкциям в приложенном файле readme.</p><br>
  <hr>

  <p style="font-size:80%;">
  © Copyright IBM Corp. 1989, 2013</p>
</body>
</html>
