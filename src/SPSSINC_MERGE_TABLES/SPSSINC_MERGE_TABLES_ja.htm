<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

  <title>2 つのビューア テーブルを結合</title>
  <style type="text/css">

  <!-- 

  H1 {font-weight:bold; color:#006699; font-size:125%; }
  H2 {font-weight:bold; color:#006699; font-size:110%; }
  TABLE {font-size:100%;}

  /* paragraph tags */
  .step {text-indent: -1.3em; margin-left:1.3em; margin-top: 0px;}
  .menuselection {margin-left:10px}
  .bullet {list-style-type: disc;margin-top:12px; margin-left:36px; text-indent:-1em; }
  .codeblock {background-color: #ffffe6; display:block; margin-left:5px; padding:5px;}

  /* inline tags */
  .screen {font-weight:bold; color:#408080}                       /*** used refer to on-screen text ***/
  .name {font-style: italic}                                                       /*** used to tag names, such as variable names, file names, and so forth ***/
  .runinhead {font-weight: bold} 
  .superscript {vertical-align:super; font-size:80%}
  .subscript {vertical-align:sub; font-size:80%}


  --> 
  </style>
</head>

<body>
  <h1>2 つのビューア テーブルを結合</h1>この手順では、あるテーブルのセル値を別のテーブルの値と結合します。セル値を提供するテーブルはセカンダリ テーブル、値を受けるテーブルはプライマリ テーブルと呼ばれます。最も一般的な使用方法は、カスタム テーブルの割合または平均値検定テーブルとメイン テーブルを結合します。他にさまざまな種類の結合が可能です。
<p>結合するセルは、2つのテーブルの行ラベルおよび列ラベルを使用して結合します。「カウント」のような最も内側のレベルの名前と結合し、同じカテゴリ ラベルに複数の統計量がある場合、値をどこへ入力するべきかを示すことができます。一部のテーブルは結合することができません。いくつかの実験を行う必要があります。  
</p>

  <p class="bullet">•&nbsp;セカンダリ テーブルの脚注は、プライマリ テーブルには引き継がれません。</p>

  <p><span class="runinhead">追加ポイント:</span> セカンダリ テーブルの値が追加される場所を定義するプライマリ テーブルの名前を含む次元を示します。
</p>

  <p><span class="runinhead">プライマリ テーブルのラベル:</span> オプションで、セカンダリ値を挿入する最も低いレベルのラベルを指定します。たとえば、テーブルには各変数カテゴリに「カウント」および「パーセント」というラベルがあります。このコントロールで、どちらを使用するかを選択します。
</p>

  <p class="bullet">•&nbsp;こうした反復ラベルがなく、カテゴリ値自体を単独で使用して結合を定義する必要がある場合、フィールドを空白にします。ただし、ラベルが存在しても非表示である場合があるため、指定する必要があるので注意してください。これにあてはまるのは、特に、「カスタム テーブル」で「統計ラベルを非表示」を選択した場合です。
</p>

  <p><span class="runinhead">プライマリおよびセカンダリ テーブル タイプ:</span> デフォルトでは、この手順はビューアの最後の 2 つのテーブルを結合し、最後のテーブルをセカンダリ テーブルとして扱います。OMS テーブルのサブタイプを入力して、他のテーブルを指定します。ビューアノ項目番号のペアを入力することもできます。ビューアのルート項目の番号は 0 です。
</p>

  <p class="bullet">•&nbsp;サブタイプは両方入力するか、どちらも入力しません。</p>

  <p class="bullet">•&nbsp;テーブルのサブタイプを検索するには、例のアウトライン タイトルを右クリックするか、<span class="screen">「ユーティリティ」</span>メニューの「OMS 識別子」ダイアログを参照します。</p>

  <p class="bullet">•&nbsp;テーブルの検索は、ビューアの最後から順に実行されます。</p>

  <p><span class="runinhead">結合モード: </span>セカンダリ値をプライマリに追加するには、<span class=
  "screen">「セカンダリ セル値をプライマリ セル値に追加」</span>を選択します。プライマリ テーブルの値をセカンダリ テーブルの値で置き換えるには、<span class=
  "screen">「プライマリ セル値をセカンダリ セル値で置き換え」</span>を選択します。セカンダリの値が使用できない場合、プライマリ値が保持されます。
</p>

  <p><span class="runinhead">結合後セカンダリ テーブルを非表示にする:</span> 結合語、セカンダリ テーブルが非表示になります。
</p>

  <p><span class="runinhead">セカンダリ テーブルのタイトルをプライマリ テーブルに追加する:</span> セカンダリ テーブルのタイトルがプライマリ テーブルのタイトルの最後に追加されます。
</p>

  <p><span class="runinhead">セカンダリ キャプションの情報を追加する:</span> セカンダリ テーブルのキャプションがプライマリ テーブルのキャプションの最後に追加されます(一部の IBMR SPSSR Statistics バージョンでは、この選択肢は機能しません)。
</p>

  <p><span class="runinhead">セカンダリ ラベルを追加する:</span> セカンダリ テーブルのラベルがプライマリ テーブルの対応する列に追加されますデータ セルで使用される区切り文字が含まれます。 
</p>

  <p><span class="runinhead">レイヤの警告脚注を非表示にする:</span> この手順は、テーブルの上位層にのみ機能します。テーブルに追加の僧がある場合、警告の脚注が追加されます。脚注が表示されないようにするには、このボックスをオンにします。
</p>

  <p><span class="runinhead">最初の行と列のラベルのレベルを印刷する:</span> 変換前後の 2 つのテーブルのすべてのラベルのレベルを表示します。テーブルのレベルが非表示の場合があるため、この情報は 2 つのテーブルのラベルを合致させる方法を指定する場合に役立ちます。
</p>

  <p><span class="runinhead">結合後セルの横方向の位置合わせ:</span> これらのコントロールを使用して、結合合にセル値の位置を合わせる方法を指定します。
</p>

  <p><span class="runinhead">ユーザ指定の区切り文字:</span> セル内でプライマリ値およびセカンダリ値を区切る文字を 1 つまたは複数入力します。値を各行に表示する場合は、&quot;\n&quot; を使用します。
</p>

  <p><span class="runinhead">結合:</span> ラベルの結合方法の詳細を指定するには、<span class="screen">「結合」</span>ボタンをクリックします。</p>

  <h2>「ラベル結合規則をカスタマイズ」サブダイアログ</h2>ピボット テーブルのセルは、行ラベルおよび列ラベルに適用される次の規則に従って合致します。
<p class="bullet">•&nbsp; ラベルはレベルの選択によってフィルタリングされます。プライマリ テーブルおよびセカンダリ テーブルの行コントロールおよび列コントロールに 1 つまたは複数の番号を入力して、セルの合致に使用するレベルを選択できます。たとえば、テーブルの次元のラベルが <br>
  <span class="code">A B C</span><br>
  の場合、レベル 0 が A、レベル 1 が B、レベル 2 が C となります。
  コントロールに 1,2 と入力すると、ラベル セットが<br>
  <span class="code">B C</span><br>
に変換され、もう一方のテーブルの対応する次元のラベル セットと合致させようとします。構造が異なる場合、2 つのテーブルで異なる選択を行う必要があります。
</p>

  <p class="bullet">•&nbsp;ラベル セットの変換では、番号を入力する順序を使用します。つまり、1 2 と 2 1 では、異なる結果となります。</p>

  <p class="bullet">•&nbsp;メイン ダイアログの<span class="screen">「最初の行と列のラベルのレベルを印刷する」</span>チェックボックスを使用して、テーブルのすべての構造を確認します。</p>

  <p class="bullet">•&nbsp;レベル フィルタリングの後、ユーザー作成関数または標準 Python 関数を呼び出してラベルをさらに変換できます。たとえば、一方テーブルのラベルが
  <span class="screen">「Pearson の相関」</span>で、別のテーブルの
  対応するラベルが <span class=
  "screen">「相関係数」</span>の場合があります。カスタム関数を使用して、生成されるセットが合致するよう、いずれかのラベルを変換することができます。
</p>

  <p class="bullet">•&nbsp;カスタム テーブルに「統計量」という、非表示のレベルがある場合があります。デフォルトでは、重要なテーブルをメイン テーブルに結合する場合、このレベルは省略されます。シンタックスでこの設定を上書きできます。
</p>

  <p class="bullet">•&nbsp;関数が None を返す場合、セルは結合されません。</p>

  <p class="bullet">•&nbsp;標準関数の機能は、<span class="screen">「追加ポイントの次元」</span>設定によって異なります。<span class="screen">「列」</span>について、行関数は何もしませんが、列関数が最後のレベルの列ラベルを削除します。<span class="screen">「行」</span>の場合、行関数は、最後のレベルのラベルが追加ポイントのラベルに一致する場合、これを削除します。列関数はセカンダリ テーブルの最後とのレベルを削除しますが、プライマリ テーブルでは何も実行しません。
</p>

  <p class="bullet">•&nbsp;標準関数は、「カスタム テーブル」メイン テーブルおよび「列比率」または「列の平均値」検定テーブルを扱うよう設計されています。通常、これらのテーブルでレベルのフィルタリングを使用する必要はありません。メイン テーブルの追加ポイント ラベルは、メイン テーブルの各カテゴリに複数の統計量がある場合、セカンダリ値をどこに追加するかを指定します。他の種類の結合に標準関数を使用できないようにしたい場合があります。
</p>

  <p><span class="runinhead">結合関数のタイプ:</span> 関数の標準セットまたはカスタム セットを選択します。
</p>

  <p class="bullet">•&nbsp;カスタム セットを選択すると、標準行関数も標準列関数も適用されません。カスタム行関数またはカスタム列関数があれば、適用されます。行関数および列関数を両方指定する必要はありません。「カスタム」を選択して関数名を入力していない場合、関数は適用されません。</p>

  <p><span class="runinhead">カスタム行関数またはカスタム列関数:</span> 関数名を <br>
module.function <br>
の形式で入力します。module は Python モジュール名で関数が定義されます。これらの関数は、2 つ目のラジオ ボタンが設定されている場合にのみ使用されます。</p>

  <h2>その他の機能</h2>

  <p>このダイアログは、SPSSINC MERGE TABLES 拡張コマンドのシンタックスを生成します。このコマンドのヘルプを表示するには、次のシンタックスを実行します。</p>

  <p class="codeblock">SPSSINC MERGE TABLES /HELP</p>

  <p>追加機能では、プライマリ テーブルおよびセカンダリ テーブルを選択できます。複雑なテーブルの場合、結合前に行ラベルおよび列ラベルを処理するカスタム関数 rowfunc および colfunc 関数を記述する必要があります。また、ラベル テキストではなく、行または列の番号に基づいてテーブルを結合することもできます。SPSSINC_MERGE_TABLES に、この処理を行う rowfuncbynumber および colfuncbynumber という名前のサンプル関数が含まれています。SPSSINC_MERGE_TABLES.py モジュールに、カスタム結合関数の使用に関する詳細情報が含まれています。</p>

  <h2>要件</h2>

  <p>このダイアログには Integration Plug-In for Python と SPSSINC MERGE TABLES 拡張コマンドが必要です。IBM SPSS Statistics 19 以上の場合、Plug-in と拡張コマンドが Essentials for Python パッケージとともにインストールされます。詳しくは、IBM SPSS Statistics ヘルプ システムの「コア システム」&gt;「よくある質問」の『Integration Plug-In の取得方法』を参照してください。SPSS コミュニティーから SPSSINC MERGE TABLES をダウンロードした場合、関連する readme ファイルの指示に従ってください。</p><br>
  <hr>

  <p style="font-size:80%;">
  © Copyright IBM Corp. 1989, 2013</p>
</body>
</html>
